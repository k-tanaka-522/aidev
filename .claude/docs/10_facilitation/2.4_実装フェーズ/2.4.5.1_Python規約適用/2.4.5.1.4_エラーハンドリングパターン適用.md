# 2.4.5.1.4 エラーハンドリングパターン適用（Python）

## 📋 目的

Pythonの適切なエラーハンドリングパターンを適用する

---

## ✅ エラーハンドリングパターン

### パターン1: 基本的なtry-except

```python
# ✅ Good Example
import logging

logger = logging.getLogger(__name__)

def read_file(file_path: str) -> str:
    """ファイルを読み込む"""
    try:
        with open(file_path, "r", encoding="utf-8") as f:
            return f.read()
    except FileNotFoundError:
        logger.error(f"ファイルが見つかりません: {file_path}")
        raise
    except Exception as e:
        logger.error(f"ファイル読み込みエラー: {e}")
        raise
```

### パターン2: カスタム例外

```python
# ✅ Good Example
class UserNotFoundError(Exception):
    """ユーザーが見つからない場合のエラー"""
    pass

def get_user(user_id: int) -> dict:
    user = db.query(user_id)
    if user is None:
        raise UserNotFoundError(f"User {user_id} not found")
    return user
```

### パターン3: FastAPIのHTTPException

```python
# ✅ Good Example
from fastapi import HTTPException, status

def get_user(user_id: int) -> dict:
    user = db.query(user_id)
    if user is None:
        raise HTTPException(
            status_code=status.HTTP_404_NOT_FOUND,
            detail=f"User {user_id} not found"
        )
    return user
```

---

## ❌ Bad Examples

### Bad: 例外を握りつぶす

```python
# ❌ Bad
try:
    risky_operation()
except Exception:
    pass  # 何もしない
```

### Bad: ログなしでre-raise

```python
# ❌ Bad
try:
    risky_operation()
except Exception:
    raise  # ログなし
```

---

## ✅ チェックリスト

- [ ] 適切な例外をcatch
- [ ] ログ出力（logger.error）
- [ ] カスタム例外の使用
- [ ] HTTPExceptionの使用（FastAPI）
- [ ] 例外を握りつぶさない

---

**最終更新**: 2025-10-19
