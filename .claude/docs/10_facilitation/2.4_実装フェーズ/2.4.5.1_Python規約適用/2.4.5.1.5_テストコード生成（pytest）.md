# 2.4.5.1.5 ãƒ†ã‚¹ãƒˆã‚³ãƒ¼ãƒ‰ç”Ÿæˆï¼ˆpytestï¼‰

## ğŸ“‹ ç›®çš„

pytestã‚’ä½¿ç”¨ã—ãŸãƒ†ã‚¹ãƒˆã‚³ãƒ¼ãƒ‰ã‚’ç”Ÿæˆã™ã‚‹

---

## ğŸ“ ãƒ†ã‚¹ãƒˆãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹æˆ

```
tests/
â”œâ”€â”€ __init__.py
â”œâ”€â”€ conftest.py                 # pytestè¨­å®šãƒ»fixture
â”œâ”€â”€ test_models/
â”‚   â”œâ”€â”€ __init__.py
â”‚   â””â”€â”€ test_user.py
â”œâ”€â”€ test_routers/
â”‚   â”œâ”€â”€ __init__.py
â”‚   â””â”€â”€ test_users.py
â””â”€â”€ test_services/
    â”œâ”€â”€ __init__.py
    â””â”€â”€ test_user_service.py
```

---

## âœ… ãƒ†ã‚¹ãƒˆã‚³ãƒ¼ãƒ‰ãƒ‘ã‚¿ãƒ¼ãƒ³

### ãƒ‘ã‚¿ãƒ¼ãƒ³1: åŸºæœ¬çš„ãªãƒ†ã‚¹ãƒˆ

```python
# âœ… Good Example
import pytest
from src.services.user_service import get_user

def test_get_user_æ­£å¸¸ç³»():
    """ãƒ¦ãƒ¼ã‚¶ãƒ¼å–å¾—ã®æ­£å¸¸ç³»ãƒ†ã‚¹ãƒˆ"""
    # Arrange
    user_id = 1
    
    # Act
    user = get_user(user_id)
    
    # Assert
    assert user["id"] == 1
    assert user["name"] == "Taro"

def test_get_user_ç•°å¸¸ç³»_ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒå­˜åœ¨ã—ãªã„():
    """ãƒ¦ãƒ¼ã‚¶ãƒ¼å–å¾—ã®ç•°å¸¸ç³»ãƒ†ã‚¹ãƒˆï¼ˆãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒå­˜åœ¨ã—ãªã„ï¼‰"""
    # Arrange
    user_id = 9999
    
    # Act & Assert
    with pytest.raises(UserNotFoundError):
        get_user(user_id)
```

### ãƒ‘ã‚¿ãƒ¼ãƒ³2: fixtureä½¿ç”¨

```python
# conftest.py
import pytest

@pytest.fixture
def sample_user():
    """ãƒ†ã‚¹ãƒˆç”¨ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ‡ãƒ¼ã‚¿"""
    return {"id": 1, "name": "Taro", "email": "taro@example.com"}

# test_user_service.py
def test_create_user(sample_user):
    """ãƒ¦ãƒ¼ã‚¶ãƒ¼ä½œæˆãƒ†ã‚¹ãƒˆ"""
    result = create_user(sample_user)
    assert result["id"] == sample_user["id"]
```

### ãƒ‘ã‚¿ãƒ¼ãƒ³3: FastAPI ãƒ†ã‚¹ãƒˆ

```python
# âœ… Good Example
from fastapi.testclient import TestClient
from src.main import app

client = TestClient(app)

def test_read_user():
    """GET /users/{user_id} ã®ãƒ†ã‚¹ãƒˆ"""
    response = client.get("/users/1")
    assert response.status_code == 200
    assert response.json()["id"] == 1
```

---

## âœ… ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ

- [ ] tests/ ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªä½œæˆ
- [ ] conftest.py ä½œæˆï¼ˆfixtureå®šç¾©ï¼‰
- [ ] ãƒ†ã‚¹ãƒˆé–¢æ•°åï¼šæ—¥æœ¬èªã§æ„å›³æ˜ç¢ºåŒ–
- [ ] Arrange-Act-Assert ãƒ‘ã‚¿ãƒ¼ãƒ³
- [ ] æ­£å¸¸ç³»ãƒ»ç•°å¸¸ç³»ä¸¡æ–¹ãƒ†ã‚¹ãƒˆ

---

**æœ€çµ‚æ›´æ–°**: 2025-10-19
