# aidev 3周テスト 総合計画

**作成日**: 2025-10-24
**目的**: aidev の実用性を検証し、技術標準・PHASE_GUIDE.md をブラッシュアップする

---

## 🎯 テスト目的

### 主目的

**aidev（PHASE_GUIDE.mdアプローチ）で、実際の開発プロセスが回るか検証する**

### 副次的目的

1. **技術標準（`.claude/docs/40_standards/`）の完全性を検証**
   - 不足している標準を洗い出す
   - 既存標準の改善点を洗い出す

2. **PHASE_GUIDE.md の実用性を検証**
   - 各フェーズの PHASE_GUIDE.md が機能するか
   - 改善が必要な箇所を洗い出す

3. **CLAUDE.md の指示の妥当性を検証**
   - Claude が正しくドキュメントを読み込むか
   - 指示が明確か

4. **実デプロイの成功を確認**
   - dry-run が成功するか
   - 本番デプロイが成功するか
   - ロールバックが成功するか

---

## 📋 テスト範囲

### 対象フェーズ

| フェーズ | テスト範囲 | 理由 |
|---------|-----------|------|
| 企画 | ❌ 範囲外 | 固定（既存の企画書を使用） |
| 要件定義 | ❌ 範囲外 | 固定（既存の要件定義書を使用） |
| **設計** | ✅ 範囲内 | **0から実施** |
| **実装** | ✅ 範囲内 | **0から実施** |
| **テスト** | ✅ 範囲内 | **0から実施** |
| **納品** | ✅ 範囲内 | **0から実施** |

### インプット（固定）

**AWS-ECS-Forgate プロジェクトの企画書・要件定義書**:
- `docs/01_企画書.md`
- `docs/02_要件定義書.md`

これらは https://github.com/k-tanaka-522/AWS-ECS-Forgate から取得

### アウトプット（検証対象）

**各周で生成される成果物**:
- `docs/03_基本設計書.md`
- `src/` - FastAPI コード
- `tests/` - テストコード
- `infra/cloudformation/` - CloudFormation テンプレート
- `scripts/` - デプロイスクリプト
- `README.md`
- `docs/デプロイ手順書.md`
- `docs/運用手順書.md`

---

## 🔄 各周の目的

### 1周目: 初見実行・問題点の洗い出し

**目的**:
- 現状の aidev で何ができるか確認
- 問題点を洗い出す
- 技術標準の不足を洗い出す

**期待される問題（仮説）**:
- デプロイスクリプトが生成されない
- FastAPI のベストプラクティスが不足
- Docker 標準がない
- GitHub Actions 標準がない

### 2周目: 改善版で再実行

**目的**:
- 1周目の問題が解消されているか確認
- 新しい問題がないか確認
- 改善の効果を測定

**期待される改善**:
- デプロイスクリプトが生成される
- FastAPI コードの品質が向上
- テストカバレッジが向上

### 3周目: 完成度確認

**目的**:
- 実用レベルに達しているか確認
- 本番プロジェクトで使えるか確認
- Bedrock Multi-Agent 化の必要性を判断

**期待される状態**:
- 必須項目すべて合格
- 推奨項目 8割以上合格
- 実用レベル判定: 本番使用可能

---

## 📊 評価指標

### 定量指標

| 指標 | 目標値 | 測定方法 |
|------|--------|----------|
| デプロイスクリプト生成 | 100% | スクリプトファイルの存在確認 |
| テストカバレッジ | 80%+ | pytest --cov 実行 |
| CloudFormation 3 principles 準拠 | 100% | レビューで確認 |
| dry-run 成功率 | 100% | Change Set 作成成功 |
| 本番デプロイ成功率 | 100% | デプロイ実行成功 |
| ロールバック成功率 | 100% | ロールバック実行成功 |

### 定性指標

| 指標 | 評価方法 |
|------|----------|
| 技術標準参照の正確性 | レビューで確認（アーキテクト視点） |
| 代替案・トレードオフの妥当性 | レビューで確認（アーキテクト視点） |
| コード品質 | レビューで確認（CTO視点） |
| ドキュメント品質 | レビューで確認（CTO視点） |
| ユーザー体験（対話の自然さ） | テスト実行者の主観評価 |

---

## 👥 役割分担

### テスト実行者（あなた）

**役割**:
- テスト計画作成
- テスト実行（Claude との対話）
- テストレポート作成

### システムアーキテクト（あなた）

**役割**:
- 設計フェーズのレビュー
- 技術選定の妥当性評価
- 代替案・トレードオフの評価

### CTO（あなた）

**役割**:
- 技術標準の完全性評価
- PHASE_GUIDE.md の実用性評価
- 総合的な品質評価
- Bedrock Multi-Agent 化の判断

---

## 📝 テスト実施プロセス

### フェーズ1: 計画作成（2時間）

**作成するドキュメント**:
- [x] `test-plan.md` - 総合テスト計画（このファイル）
- [ ] `round1-plan.md` - 1周目詳細計画
- [ ] `round2-plan.md` - 2周目詳細計画
- [ ] `round3-plan.md` - 3周目詳細計画

### フェーズ2: 1周目実行（4-6時間）

**手順**:
1. テスト環境セットアップ（30分）
2. Claude Code で実行（3-4時間）
   - 設計フェーズ
   - 実装フェーズ
   - テストフェーズ
   - 納品フェーズ
3. 実デプロイ検証（1時間）
4. レポート作成（1時間）

### フェーズ3: 1周目レビュー・改善（2-3時間）

**手順**:
1. システムアーキテクト視点でレビュー（1時間）
2. CTO 視点でレビュー（1時間）
3. 改善実施（1時間）
   - 技術標準更新
   - PHASE_GUIDE.md 更新
   - CLAUDE.md 更新

### フェーズ4: 2周目実行（3-4時間）

**手順**:
1. テスト環境セットアップ（15分）
2. Claude Code で実行（2-3時間）
3. 実デプロイ検証（30分）
4. レポート作成（30分）

### フェーズ5: 2周目レビュー・改善（1-2時間）

**手順**:
1. 改善効果の確認（30分）
2. 残存問題のレビュー（30分）
3. 改善実施（1時間）

### フェーズ6: 3周目実行（2-3時間）

**手順**:
1. テスト環境セットアップ（15分）
2. Claude Code で実行（1.5-2時間）
3. 実デプロイ検証（30分）
4. レポート作成（30分）

### フェーズ7: 最終レポート作成（2時間）

**内容**:
- 3周の比較
- 総合評価
- aidev の完成度評価
- Bedrock Multi-Agent 化の判断
- 今後のロードマップ

---

## 🚀 実デプロイ検証プロセス

### 前提条件

- [ ] AWS CLI インストール済み
- [ ] AWS 認証情報設定済み
- [ ] 必要な権限あり（CloudFormation, ECS, RDS, VPC）

### 検証ステップ

#### 1. dry-run 実行

```bash
cd test/round1  # または round2, round3

# Change Set 作成
./scripts/create-changeset.sh test-stack-round1

# Change Set 確認
./scripts/describe-changeset.sh test-stack-round1
```

**確認ポイント**:
- [ ] スクリプトが存在する
- [ ] スクリプトが実行できる
- [ ] Change Set が作成される
- [ ] 意図しないリソース削除がない
- [ ] 作成されるリソースが設計通り

#### 2. 本番デプロイ実行

```bash
# デプロイ実行
./scripts/execute-changeset.sh test-stack-round1
```

**確認ポイント**:
- [ ] デプロイが成功する
- [ ] ECS サービスが起動する
- [ ] ヘルスチェックが通る

#### 3. 動作確認

```bash
# ALB DNS 取得
aws cloudformation describe-stacks \
  --stack-name test-stack-round1 \
  --query 'Stacks[0].Outputs[?OutputKey==`LoadBalancerDNS`].OutputValue' \
  --output text

# ヘルスチェック
curl http://<ALB-DNS>/health

# 期待レスポンス: {"status": "ok"}
```

**確認ポイント**:
- [ ] ALB にアクセスできる
- [ ] ヘルスチェックが通る
- [ ] API エンドポイントが動作する

#### 4. ロールバック実行

```bash
# ロールバック
./scripts/rollback.sh test-stack-round1

# リソースクリーンアップ確認
aws cloudformation list-stacks --stack-status-filter DELETE_COMPLETE
```

**確認ポイント**:
- [ ] ロールバックが成功する
- [ ] すべてのリソースがクリーンアップされる
- [ ] 残存リソースがない

---

## 📈 レビュープロセス

### システムアーキテクト視点のレビュー

**レビュー項目**:

#### 設計フェーズ
- [ ] 技術選定の妥当性
- [ ] 代替案の提示
- [ ] トレードオフの説明
- [ ] システム構成図の分かりやすさ
- [ ] スケーラビリティの考慮
- [ ] セキュリティの考慮
- [ ] コストの最適化

#### 実装フェーズ
- [ ] アーキテクチャの実装
- [ ] コンポーネント分割の適切性
- [ ] インターフェース設計
- [ ] データフロー設計

#### インフラ設計
- [ ] CloudFormation 3 principles 準拠
- [ ] ネットワーク設計
- [ ] セキュリティグループ設計
- [ ] IAM ロール設計

### CTO 視点のレビュー

**レビュー項目**:

#### 技術標準の完全性
- [ ] 今回のプロジェクトで不足している標準はないか
- [ ] 既存標準に改善点はないか
- [ ] 新しいベストプラクティスが見つかったか

#### プロセスの実用性
- [ ] PHASE_GUIDE.md は実用的だったか
- [ ] 改善が必要な箇所はどこか
- [ ] CLAUDE.md の指示は適切だったか

#### 組織的な観点
- [ ] チームで使えるレベルか
- [ ] 属人化を防げているか
- [ ] 品質が担保されているか
- [ ] ドキュメントが十分か

#### コード品質
- [ ] コーディング規約準拠
- [ ] テストカバレッジ
- [ ] エラーハンドリング
- [ ] セキュリティ

---

## 🎯 最終判定基準

### 実用レベル判定

#### 本番使用可能（80点以上）
- 必須項目すべて合格
- 推奨項目 8割以上合格
- 重大な問題なし

**判定結果**: Bedrock Multi-Agent 化は不要。aidev で十分。

#### 一部改善必要（60-79点）
- 必須項目すべて合格
- 推奨項目 6-7割合格
- 軽微な問題のみ

**判定結果**: 改善後に再評価。Bedrock Multi-Agent 化は保留。

#### 改善必要（60点未満）
- 必須項目に不合格あり
- または推奨項目 6割未満

**判定結果**: さらなる改善が必要。Bedrock Multi-Agent 化を検討。

### Bedrock Multi-Agent 化の判断基準

**移行すべきケース**:
- [ ] PHASE_GUIDE.md でコンテキストサイズが限界に達する
- [ ] 複数の専門知識を並行して活用したい
- [ ] より自然なオーケストレーションが必要
- [ ] エージェント間の情報共有が必要

**aidev 継続で十分なケース**:
- [ ] PHASE_GUIDE.md で問題なく動作する
- [ ] コンテキストサイズが問題にならない
- [ ] ユーザー体験が十分に良い
- [ ] 実用レベル（80点以上）に達している

---

## 📅 スケジュール

| フェーズ | 期間 | 作業内容 |
|---------|------|----------|
| 計画作成 | 2時間 | テスト計画書作成 |
| 1周目実行 | 4-6時間 | テスト実行・レポート作成 |
| 1周目レビュー | 2-3時間 | レビュー・改善実施 |
| 2周目実行 | 3-4時間 | テスト実行・レポート作成 |
| 2周目レビュー | 1-2時間 | レビュー・改善実施 |
| 3周目実行 | 2-3時間 | テスト実行・レポート作成 |
| 最終レポート | 2時間 | 総合評価・判断 |
| **合計** | **16-22時間** | |

---

## 📄 関連ドキュメント

- `round1-plan.md` - 1周目詳細計画
- `round2-plan.md` - 2周目詳細計画
- `round3-plan.md` - 3周目詳細計画
- `../reports/round1-report.md` - 1周目レポート
- `../reports/round2-report.md` - 2周目レポート
- `../reports/round3-report.md` - 3周目レポート
- `../reports/final-report.md` - 最終レポート

---

**作成日**: 2025-10-24
**作成者**: Claude（AI開発ファシリテーター）
**承認者**: [あなたの名前]
