# ラウンド3テスト実施指示書

**目的**: ラウンド2で残った課題（Change Set対応）を改善し、最終検証を行う

---

## 📋 事前準備

### 1. ラウンド2の改善を確認

以下がラウンド2で改善済み：
- ✅ 基本設計書13章完全生成（23% → 100%）
- ✅ CloudFormation生成順序の改善
- ✅ テストフェーズ PHASE_GUIDE.md 作成完了（30KB）

### 2. ラウンド3での改善目標

**最重要課題**: Change Set による段階的デプロイの実装

現状の問題:
- `aws cloudformation deploy` で直接デプロイ
- dry-run プロセスなし
- 本番環境での安全性不足

ラウンド3で生成すべきスクリプト:
- [ ] `scripts/create-changeset.sh` - Change Set作成
- [ ] `scripts/describe-changeset.sh` - Change Set内容確認
- [ ] `scripts/execute-changeset.sh` - Change Set実行
- [ ] `scripts/rollback.sh` - ロールバック

---

## 🚀 実施手順

### Step 1: 最新の aidev を取得

```bash
cd /c/dev2/aiDev
git pull origin main
```

### Step 2: AWS-ECS-Forgate の最新を取得

```bash
cd [AWS-ECS-Forgateのパス]
git pull origin main
```

### Step 3: テスト環境準備（別セッションで実施）

**新しい Claude Code セッションを開く**

### Step 4: Claude に以下を指示（コピペ）

```
設計フェーズから開始します。

docs/01_企画書.md と docs/02_要件定義書.md を読んで、AWS Multi-Account構成でのインフラ設計を行ってください。

技術要件:
- CloudFormation でインフラ構築
- Platform Account: 共通ネットワーク基盤（Transit Gateway, VPN）
- Service Account: 3サービス構成（Public Web, Admin Dashboard, Batch）
- ECS Fargate + RDS PostgreSQL + ALB

**重要: デプロイスクリプトは必ず Change Set を使った段階的デプロイ方式で生成してください。**
- create-changeset.sh
- describe-changeset.sh
- execute-changeset.sh
- rollback.sh

設計が完了したら、実装フェーズ、テストフェーズ、納品フェーズと順番に進めてください。
```

---

## 🔍 観察ポイント（重要）

### 最重要確認項目

#### 1. Change Set スクリプトの生成 ⭐⭐⭐
**確認方法**: `ls -la scripts/`

期待されるファイル:
- [ ] `scripts/create-changeset.sh` - 生成された
- [ ] `scripts/describe-changeset.sh` - 生成された
- [ ] `scripts/execute-changeset.sh` - 生成された
- [ ] `scripts/rollback.sh` - 生成された

**スクリプト内容の確認**:
- [ ] `aws cloudformation create-change-set` を使用
- [ ] Change Set の内容を確認するステップあり
- [ ] ユーザー確認後に実行する設計
- [ ] エラーハンドリング実装

#### 2. 基本設計書の完全生成（継続確認）
**確認方法**: `ls -la docs/03_基本設計書/`

- [ ] 13章すべて生成された
- [ ] 各章に実質的な内容がある（テンプレートだけでない）

#### 3. CloudFormation 3 Principles 準拠
**確認方法**: 会話ログ、生成されたテンプレート

- [ ] 責任分離原則（スタック分割）
- [ ] テンプレート分割原則（ネスト構造）
- [ ] **段階的デプロイ原則（Change Set使用）** ← ラウンド3の焦点

#### 4. テストフェーズの実施内容
**確認方法**: 会話ログ、生成されたテストコード

- [ ] 統合テスト実施
- [ ] E2Eテスト実施
- [ ] 性能テスト実施
- [ ] セキュリティテスト実施

#### 5. デプロイ手順書の内容
**確認方法**: `docs/デプロイ手順書.md`

- [ ] Change Set を使った手順が記載されている
- [ ] dry-run（Change Set確認）ステップがある
- [ ] ロールバック手順が詳細に記載されている

---

## 📝 記録すべき内容

### 成功事例
- [ ] Change Set スクリプトが自動生成された
- [ ] スクリプトの内容が実用的
- [ ] デプロイ手順書に Change Set 手順が含まれる
- [ ] 基本設計書13章完全生成（ラウンド2から継続）

### 問題点
- [ ] Change Set スクリプトが生成されなかった
- [ ] スクリプトは生成されたが内容が不十分
- [ ] デプロイ手順書に Change Set 手順がない
- [ ] その他の問題点

### 所要時間
- 設計フェーズ: XX分
- 実装フェーズ: XX分
- テストフェーズ: XX分
- 納品フェーズ: XX分
- **合計**: XX時間XX分

---

## 📊 評価基準

### Change Set 対応評価

| 項目 | 配点 | 評価基準 |
|------|------|----------|
| create-changeset.sh 生成 | 10点 | 生成され、実用的な内容 |
| describe-changeset.sh 生成 | 10点 | Change Set 内容を表示 |
| execute-changeset.sh 生成 | 10点 | ユーザー確認後に実行 |
| rollback.sh 生成 | 10点 | ロールバック機能 |
| デプロイ手順書 | 10点 | Change Set 手順記載 |
| **合計** | **50点** | 40点以上で合格 |

### 総合評価（ラウンド2からの継続項目含む）

| 項目 | ラウンド2 | ラウンド3目標 |
|------|-----------|---------------|
| 基本設計書生成 | 10/10 | 10/10 |
| CloudFormation実装 | 9/10 | 10/10 |
| Change Set対応 | 0/10 | **8-10/10** |
| デプロイスクリプト | 8/10 | **10/10** |
| ドキュメント品質 | 9/10 | 9-10/10 |
| テストフェーズ実施 | ?/10 | 8-10/10 |
| **総合** | 80/100 | **85-95/100** |

---

## 🎯 ラウンド3成功の定義

### 必須条件（すべて満たす必要あり）
1. ✅ Change Set スクリプト4つすべて生成
2. ✅ スクリプトが実用的（dry-run → 確認 → 実行 の流れ）
3. ✅ 基本設計書13章完全生成

### 推奨条件（8割以上達成）
1. デプロイ手順書に Change Set 手順記載
2. テストフェーズが充実（統合、E2E、性能、セキュリティ）
3. ロールバック手順が詳細

### 実用レベル判定
- **90点以上**: 本番プロジェクトで即使用可能
- **85-89点**: 軽微な調整で本番使用可能
- **80-84点**: 一部改善必要
- **80点未満**: 追加改善必要

---

## 📈 期待される結果

ラウンド3で Change Set 対応が完了すれば:

1. ✅ **本番環境への安全なデプロイ** が可能
2. ✅ **dry-run による事前確認** ができる
3. ✅ **ロールバック** が容易
4. ✅ **受託開発納品レベル** の品質に到達

→ **aidev が実用レベルに到達**

---

## 🔄 ラウンド3実施後の流れ

### 1. 結果の記録
- test/reports/ROUND3_SUMMARY.md を作成
- 成功事例と問題点を記録

### 2. aidev への反映
- 問題点があれば .claude/ に改善を反映
- 必要に応じて PHASE_GUIDE.md を更新

### 3. 最終判断
- **85点以上**: aidev 完成、Bedrock Multi-Agent 化は不要
- **85点未満**: 追加改善または Bedrock Multi-Agent 化を検討

---

## 📌 その他の注意事項

### Claude との対話
- 自然な会話を心がける
- Claude が提案する内容をよく読む
- 疑問があれば質問する

### トラブルシューティング
- Change Set スクリプトが生成されない場合
  → 「Change Set を使ったデプロイスクリプトを生成してください」と明示的に依頼

- 基本設計書が途中で止まる場合
  → 「残りの章も生成してください」と依頼

- テストフェーズが簡素な場合
  → 「統合テスト、E2Eテスト、性能テストを実施してください」と依頼

---

**作成日**: 2025-10-24  
**作成者**: Claude（AI開発ファシリテーター）

**ラウンド3、頑張ってください！**
