# ラウンド4 テスト計画

**目的**: ラウンド3の知見を .claude に反映した改善版で、自動的に Change Set + テストフェーズが実施されるか検証

---

## 📋 事前準備

### 改善内容の確認

**ラウンド3で発見された問題** → **今回の改善**:

1. **Change Set スクリプトが生成されなかった**
   - ユーザーが「Change Set を使ってください」と明示的に指示する必要があった
   - → `.claude/docs/10_facilitation/2.4_実装フェーズ/PHASE_GUIDE.md` に Change Set 必須を明記
   - → **ラウンド4では自動生成されるはず**

2. **テストフェーズが実施されなかった**
   - テストフェーズをスキップした（-10点）
   - → `CLAUDE.md` にテストフェーズ必須を明記
   - → **ラウンド4では自動的にテストフェーズを実施するはず**

---

## 🎯 ラウンド4の目標

### 必須達成項目

1. ✅ **Change Set スクリプト4つ自動生成** ← ラウンド3の改善
   - create-changeset.sh
   - describe-changeset.sh
   - execute-changeset.sh
   - rollback.sh
   - **ユーザーが指示しなくても生成される**

2. ✅ **テストフェーズ自動実施** ← ラウンド3の改善
   - 統合テスト
   - E2Eテスト
   - 性能テスト
   - セキュリティテスト
   - **自動的に実施される**

3. ✅ **基本設計書13章完全生成** ← ラウンド2から継続
   - 段階的生成プロセスが機能

### 目標スコア

**90点以上**（実用レベル完全達成）

| 項目 | ラウンド3 | ラウンド4目標 |
|------|-----------|--------------|
| 基本設計書生成 | 10/10 | 10/10 |
| CloudFormation実装 | 9/10 | 10/10 |
| Change Set対応 | 8/10 | **10/10** ⭐ |
| デプロイスクリプト | 9/10 | **10/10** ⭐ |
| テストフェーズ実施 | 0/10 | **10/10** ⭐ |
| ドキュメント品質 | 9/10 | 10/10 |
| **総合** | 82/100 | **90-95/100** |

---

## 🚀 実施手順

### Step 1: aidev の最新版を取得

```bash
cd /c/dev2/aiDev
git add .
git commit -m "feat: Add Round 3 improvements - Change Set auto-generation and mandatory testing"
git push
```

### Step 2: テスト環境準備

**AWS-ECS-Forgate リポジトリで実施**:

```bash
cd [AWS-ECS-Forgateのパス]
git pull origin main

# 最新の aidev を取得
cd /c/dev2/aiDev
git pull origin main
```

### Step 3: 新しい Claude Code セッションを開く

**重要**: 必ず**新しいセッション**で開始してください。

### Step 4: Claude に指示（コピペ）

```
設計フェーズから開始します。

docs/01_企画書.md と docs/02_要件定義書.md を読んで、AWS Multi-Account構成でのインフラ設計を行ってください。

技術要件:
- CloudFormation でインフラ構築
- Platform Account: 共通ネットワーク基盤（Transit Gateway, VPN）
- Service Account: 3サービス構成（Public Web, Admin Dashboard, Batch）
- ECS Fargate + RDS PostgreSQL + ALB

設計が完了したら、実装フェーズ、テストフェーズ、納品フェーズと順番に進めてください。
```

**注意**: 
- ❌ 「Change Set を使ってください」とは指示しない
- ❌ 「テストフェーズを実施してください」とは指示しない
- → Claude が自動的に実施するか確認

---

## 🔍 観察ポイント

### 最重要確認項目

#### 1. Change Set スクリプト自動生成 ⭐⭐⭐

**確認タイミング**: 実装フェーズ

**期待される動作**:
- Claude が `.claude/docs/10_facilitation/2.4_実装フェーズ/PHASE_GUIDE.md` を読む
- 「Change Set スクリプト必須」を認識
- **ユーザーが指示しなくても** 4つのスクリプトを生成

**確認方法**:
```bash
ls -la scripts/
```

**期待されるファイル**:
- [ ] create-changeset.sh
- [ ] describe-changeset.sh
- [ ] execute-changeset.sh
- [ ] rollback.sh

**失敗の場合**:
- Claude が deploy.sh だけ生成した → PHASE_GUIDE.md を読んでいない可能性
- スクリプトが生成されない → 改善が不十分

#### 2. テストフェーズ自動実施 ⭐⭐⭐

**確認タイミング**: 実装フェーズ完了後

**期待される動作**:
- 実装フェーズ完了後、Claude が自動的にテストフェーズに移行
- `CLAUDE.md` の「テストフェーズはスキップ禁止」を認識
- **ユーザーが指示しなくても** テストを実施

**確認方法**: 会話ログを確認

**期待される流れ**:
1. Claude: 「実装フェーズが完了しました。次にテストフェーズを実施します」
2. Claude: 統合テスト、E2Eテスト、性能テスト、セキュリティテストを実施
3. Claude: テスト結果を報告

**失敗の場合**:
- 実装フェーズ後、いきなり納品フェーズに移行 → CLAUDE.md を読んでいない可能性
- テストフェーズをスキップ → 改善が不十分

#### 3. 基本設計書13章完全生成（継続確認）

**確認方法**:
```bash
ls -la docs/03_基本設計書/
```

**期待**: 13章すべて生成

---

## 📝 記録すべき内容

### 成功事例

- [ ] Change Set スクリプト自動生成された ⭐
- [ ] ユーザーが指示しなくても生成
- [ ] テストフェーズ自動実施された ⭐
- [ ] ユーザーが指示しなくても実施
- [ ] 基本設計書13章完全生成（継続達成）

### 問題点

- [ ] Change Set スクリプトが生成されなかった
- [ ] ユーザーが指示する必要があった
- [ ] テストフェーズが実施されなかった
- [ ] テストフェーズをスキップした
- [ ] その他の問題点

### 所要時間

- 設計フェーズ: XX分
- 実装フェーズ: XX分
- テストフェーズ: XX分
- 納品フェーズ: XX分
- **合計**: XX時間XX分

---

## 📊 評価基準

### ラウンド4の成功判定

#### 必須条件（すべて満たす必要あり）

1. ✅ Change Set スクリプト4つ自動生成（ユーザー指示なし）
2. ✅ テストフェーズ自動実施（ユーザー指示なし）
3. ✅ 基本設計書13章完全生成

**すべて達成** → ラウンド4成功 ✅

#### スコア評価

| 項目 | 配点 | 合格基準 |
|------|------|----------|
| Change Set 自動生成 | 20点 | ユーザー指示なしで生成 |
| テストフェーズ自動実施 | 20点 | ユーザー指示なしで実施 |
| 基本設計書完全生成 | 10点 | 13章すべて |
| CloudFormation 実装 | 10点 | 3 Principles 準拠 |
| ドキュメント品質 | 10点 | 受託開発レベル |
| **総合** | **70点** | **60点以上で合格** |

---

## 🎯 期待される結果

### ラウンド4で達成すべきこと

1. **aidev が実用レベルに到達**
   - 90点以上達成
   - ユーザー指示最小限で高品質な成果物生成

2. **自動化の実現**
   - Change Set スクリプト自動生成
   - テストフェーズ自動実施
   - ドキュメント自動生成

3. **受託開発納品レベルの品質**
   - 本番デプロイ可能
   - テスト済み
   - ドキュメント完備

---

## 🔄 ラウンド4実施後の流れ

### 1. 結果の記録

`test/reports/ROUND4_SUMMARY.md` を作成:
- 成功事例と問題点を記録
- スコア評価
- 改善提案（あれば）

### 2. 最終判断

#### パターンA: 90点以上達成
- ✅ **aidev 完成**
- Bedrock Multi-Agent 化は不要
- 本番プロジェクトで使用可能

#### パターンB: 85-89点
- 軽微な調整が必要
- ラウンド5で最終調整

#### パターンC: 85点未満
- 追加改善が必要
- 改善内容を .claude に反映
- ラウンド5実施

---

## 💡 トラブルシューティング

### Q1: Change Set スクリプトが生成されない

**対処**:
1. Claude が PHASE_GUIDE.md を読んだか確認
2. 会話ログで「45_cloudformation.md」の参照を確認
3. 必要なら「デプロイスクリプトを生成してください」と依頼

### Q2: テストフェーズがスキップされる

**対処**:
1. Claude が CLAUDE.md を読んだか確認
2. 実装フェーズ後に「次はテストフェーズです」とリマインド
3. 必要なら「テストフェーズを実施してください」と依頼

### Q3: 基本設計書が途中で止まる

**対処**:
- 「残りの章も生成してください」と依頼
- ラウンド2の改善が機能しているはずなので、発生しないはず

---

## 📌 重要事項

### ラウンド4の目的

**改善の効果を検証する**ことが最重要です。

- Change Set 自動生成の効果
- テストフェーズ必須化の効果
- aidev の実用性

### 注意点

1. **ユーザー指示は最小限に**
   - Claude が自動的に実施するか確認
   - 過度な指示は検証にならない

2. **会話ログを詳細に記録**
   - Claude がどう振る舞ったか
   - どこで問題が発生したか

3. **客観的な評価**
   - 期待通りに動作したか
   - 改善が必要な箇所はどこか

---

**作成日**: 2025-10-24  
**作成者**: Claude（AI開発ファシリテーター）

**ラウンド4、頑張ってください！**
